<!doctype html>
<html lang="ru">
<head>
	<meta charset="UTF-8">
	<meta content="width=device-width,initial-scale=1" name="viewport">
	<title>European Great Dane Champions 1900-1980</title>

	<link rel="stylesheet" href="./css/eu-gallery.css">
	<!-- CSS -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/carousel/carousel.css" />

	<style>
		p {
			font-family: 'OpenSans', sans-serif;
			font-size: 16px;
			margin: 0;
			text-align: center;
			color: white;
		}
		@media (max-width: 767px) { .sw__left { padding-top:100%; } }
		@media (min-width: 768px) { .sw__left { padding-top:50%; } }
	</style>
</head>
<body>
<p>Click/tap to enlarge - нажмите для увеличения</p>

<div class="swipe" id="app">
	<div class="sw__left">
		<div class="f-carousel" id="Carousel-1"></div>
	</div>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/carousel/carousel.umd.js"></script>

<script>
	async function createGalleryFromJSON(jsonList) {
		const carouselContainer = document.getElementById('Carousel-1');
		if (!carouselContainer) return;
		carouselContainer.innerHTML = '';

		jsonList.forEach((imageFileName) => {
			const fullImagePath = `./collection/${imageFileName}`;

			// Структура: <div class="f-carousel__slide"><a href="full" data-fancybox="gallery" data-caption="..."><img/></a></div>
			const slideDiv = document.createElement('div');
			slideDiv.className = 'f-carousel__slide';

			const link = document.createElement('a');
			link.href = fullImagePath;
			link.setAttribute('data-fancybox', 'gallery');
			link.setAttribute('data-caption', imageFileName);

			const img = document.createElement('img');
			img.src = fullImagePath;    // миниатюра — у тебя это тот же файл, можно добавить thumb если нужно
			img.alt = imageFileName;
			img.style.maxWidth = '100%';
			img.style.display = 'block';

			link.appendChild(img);
			slideDiv.appendChild(link);
			carouselContainer.appendChild(slideDiv);
		});

		// Привязываем Fancybox делегированно к элементам внутри контейнера.
		// Это важно для динамически созданных элементов.
		Fancybox.bind(carouselContainer, '[data-fancybox="gallery"]', {
			// опции Fancybox (по желанию)
			dragToClose: false,
			doubleClick: "zoom",
			Thumbs: false,
			// Toolbar и прочие опции можно настроить здесь
		});

		// Инициализируем Carousel (если нужна карусельная навигация)
		// (Carousel берёт уже вставленные .f-carousel__slide элементы)
		new Carousel(carouselContainer, {
			Navigation: true,
			Dots: true,
			center: true,
			slidesPerPage: 1,
			// другие опции Carousel по вкусу
		});
	}

	document.addEventListener('DOMContentLoaded', async () => {
		try {
			const res = await fetch('./collection/images.json');
			if (!res.ok) throw new Error(res.status + ' ' + res.statusText);
			const data = await res.json();
			createGalleryFromJSON(data);
		} catch (err) {
			console.error('Ошибка при загрузке JSON:', err);
		}
	});
</script>

</body>
</html>
